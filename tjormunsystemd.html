<!DOCTYPE HTML>
<!--
	Arcana by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="es" xml:lang="es">
	<head>
		<title>ü¶ú TricahuePool</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header">

					<!-- Logo -->
						<h1><a id="logo">ü¶ú Informacion y Tutoriales</a></h1>

					<!-- Nav -->
					<nav id="nav">
						<ul>
							<li ><a href="index.html">Inicio</a></li>
							<li>
								<a class="current">Informacion y Tutoriales</a>
								<ul>
									<li><a>Sobre Delegacion</a>
										<ul>
											<li><a href="queesladelegacion.html">¬øQue es la delegacion?</a></li>
											<li><a href="comodelegar.html">¬øComo Puedo Delegar?</a></li>
										</ul>
									</li>
									<li><a>Tutoriales Tecnicos</a>
										<ul>
											<li><a href="tjormunsystemd.html">Jormungandr con Systemd</a></li>
                                            <li><a href="iniciardaedalusconnodos.html">Iniciar Daedalus Testnet con/sin trusted peers</a></li>
										</ul>
									</li>
								</ul>
							</li>
							<li><a>Mis Programas</a>
							<ul>
								<li><a href="waira.html">Waira</a></li>
							</ul>
							</li>
							<li><a>Sobre TricahuePool</a>
								<ul>
								<li><a href="activitynews.html">Actividad del Pool</a></li>	
								<li><a href="mimaquina.html">Mi Pool</a></li>
								</ul>
							</li>
						</ul>
					</nav>

				</div>

			<!-- Main -->
				<section class="wrapper style1">
					<div class="container">
						<div id="content">

							<!-- Content -->

								<article>
									<header>
										<h2 style="text-align: center;" >Jormungander con Systemd</h2>
										<p>Como hacer corre a jormungandr como un servicio del systema bajo Systemd.</p>
									</header>

									

									<p>Systemd es un sistema para correr y gestionar servicios en Linux, en este manual aprender√°s a convertir a jormungandr en un servicio del sistema esto te permitir√° manejarlo con mayor facilidad e incluso poder arrancarlo al inicio del sistema operativo.</p>
									<h2>Archivo de configuraci√≥n</h2>
									<p>Se procede a crear un archivo de configuraci√≥n para nuestro servicio, el que llamaremos "jormungandr.service" y lo guardaremos en la ruta "/etc/systemd/system/". Ejecutamos el editor de texto nano para poder crear un archivo en esa ruta.</p>
									<p><code>nano /etc/systemd/system/jormungandr.service</code></p>
									<blockquote>
									<p>Recuerda usar el comando en modo root (administrador)</p>
									</blockquote>
									<p>Una vez ejecutado el comando se abrir√° la ventana del editor de texto. Aqu√≠ se deber√° ingresar los siguientes par√°metros.</p>
									<p style="background-color: beige">
										<code >
											[Unit]<br>
									Description=jormungandr<br>
									After=network.target<br>
									[Service]<br>
									WorkingDirectory=/ruta/donde/estan/los/archivos<br>
									Restart=on-success<br>
									RestartSec=5<br>
									ExecStart=/ruta/donde/estan/los/archivos/jormungandr --config config-StakePool.yaml --secret node-secret.yaml --genesis-block-hash 8e4d2a343f3dcf9330ad9035b3e8d168e6728904262f2c434a4f8f934ec7b676<br>
									ExecStop=/ruta/donde/estan/los/archivos/jcli rest v0 shutdown get --host "http://127.0.0.1:3100/api"<br>
									ExecStopPost=/bin/sleep 5<br>
									KillMode=control-group<br>
									LimitNOFILE=16384<br>
									User=tuusuario<br>
									Group=tuusuario<br>
									[Install]<br>
									WantedBy=multi-user.target<br>
										</code></p>
										<blockquote>
											<p>Procura poner la ruta donde se encuentran tus archivos</p>
											</blockquote>
									<p>Deveria verse algo asi como en la imagen</p>
									<span class="image featured"><img src="images/jormungandrservice.jpg" alt="" /></span>
									<p><strong><em>Los par√°metros de importancia son explicados a continuaci√≥n:</em></strong></p>
									<p><strong>Description=</strong> Es el nombre para identificar tu nodo, lo cita cuando ejecutas el servicio o lo detienes.</p>
									<p><strong>WorkingDirectory</strong>= Corresponde a la ruta del directorio de trabajo que es la ruta de la carpeta donde tienes tus ejecutables "jormundanr" y "jcli".</p>
									<p><strong>ExecStart</strong>= Aqu√≠ es donde se introduce el comando de ejecuci√≥n de inicio del servicio, debe ir el archivo que se ejecutara (incluida su ruta) y su parametros de ejecuci√≥n por ejemplo se requiere ejecutar el jormungandr, que est√° en la carpeta "Nodo" del usuario "cardano" esta l√≠nea quedar√≠a as√≠:</p>
									<p><em>ExecStart=/home/cardano/Nodo/jormungandr --config config-StakePool.yaml --secret node-secret.yaml --genesis-block-hash 8e4d2a343f3dcf9330ad9035b3e8d168e6728904262f2c434a4f8f934ec7b676</em></p>
									<blockquote>
									<p>Todo debe estar en una sola l√≠nea, un salto de l√≠nea (ENTER) entre estos par√°metros generara un error.</p>
									</blockquote>
									<p><strong>ExecStop=</strong> Igual que en el ExecStart, solo que aqu√≠ se introduce el comando de ejecuci√≥n que se usara para la detenci√≥n del servicio, desde el manual oficial se sugiere usar el comando "jcli rest v0 shutdown get --host "http://127.0.0.1:3100/api" para detener el nodo y es el que se usara en esta configuraci√≥n. Siguiendo el ejemplo anterior del usuario y carpeta, nuestra l√≠nea quedar√≠a as√≠:</p>
									<p><em>ExecStop=/home/cardano/Nodo/jcli rest v0 shutdown get --host "http://127.0.0.1:3100/api"</em></p>
									<p><strong>ExecStopPost=</strong>Este comando se ejecuta despu√©s del ExecStop y se usara para dar un tiempo de espera al nodo y as√≠ pueda realizar su proceso de detenci√≥n correctamente. En esta configuraci√≥n se dejaron 5 segundos de espera, nuestra l√≠nea quedar√≠a as√≠:</p>
									<p><em>ExecStopPost=/bin/sleep 5</em></p>
									<p><strong>KillMode=</strong> Aqu√≠ se selecciona el modo en que se detendr√° el servicio se usa por defecto "control-group" el que una vez detenido el servicio (despu√©s de haber ejecutado el ExecStop y ExecStopPost) cerrar√° a la fuerza los procesos abiertos restantes.</p>
									<p><strong>LimitNOFILE=</strong> Una configuraci√≥n muy importante, tiene relaci√≥n con la cantidad de archivos(procesos) que puede gestionar el servicio y evitar el tan famoso "too many open files‚Äù, esta configuraci√≥n se aplica √∫nicamente al servicio y es independiente de la configuraci√≥n general del sistema, se usa el valor "16384" el cual no me ha dado problemas.</p>
									<p><strong>User y Group=</strong> Estos dos par√°metros sirven para determinar bajo que permisos se ejecutara el servicio, si no se pone un User y un Group por defecto se ejecutara en modo administrador, para nuestra seguridad en esta configuraci√≥n se ejecutara el jormungandr sin modo root, ya que no es necesario y podr√≠a generar alg√∫n hueco de seguridad. As√≠ en estos dos debemos indicar que se ejecutaran en nuestro usuario que no tiene permisos root, siguiendo el ejemplo del usuario anterior, donde tenemos un usuario llamado "cardano" estas dos l√≠neas quedaran as√≠:</p>
									<p><em>User=cardano</em></p>
									<p><em>Group=cardano</em></p>
									<blockquote>
									<p>Al ejecutar el comando "ls -la" (sin comillas) en tu terminal podr√°s ver las propiedades y permisos de tus carpetas y tus archivos de la ruta que te encuentres. Puedes ver en tu carpeta donde tienes tu jormungandr en que permiso de usuario y grupo estas.</p>
									</blockquote>
									<p>Una vez ingresado correctamente tus par√°metros de configuraci√≥n, guarda tus datos que ingresaste en el archivo "jormungandr.service".</p>
									<blockquote>
									<p>En nano para guardar una modificaci√≥n se usa la combinaci√≥n de teclas "CTRL+o" y luego confirmas con un "ENTER‚Äù, para salir se usa "CTRL+x".</p>
									</blockquote>
									<h2>Ejecutando el servicio</h2>
									<p>Una vez guardado los cambios de nuestro archivo de configuraci√≥n estamos listos para ejecutar nuestro servicio.</p>
									<h4>Iniciar el servicio</h4>
									<p><code>systemctl start jormungandr</code></p>
									<p>Podemos ver el estado del servicio con el siguiente comando:</p>
									<h4>Estado del servicio</h4>
									<p><code>systemctl status jormungandr</code></p>
									<p>Si se desea parar el servicio, se usa el siguente:</p>
									<h4>Detener el servicio</h4>
									<p><code>systemctl stop jormungandr</code></p>
									<p>Una vez que vemos que todo funciona bien, si se desea, podemos hacer que el servicio se ejecute cada vez que se inicie el sistema, esto se hace con:</p>
									<p><code>systemctl enable jormungandr</code></p>
									<p>Si se desea deshabilitar el servicio al inicio del sistema se usa:</p>
									<p><code>systemctl disable jormungandr</code></p>
									<p>y eso seria todo .</p>
									<blockquote>
										<p>Si deseas apoyarme para seguir creando mas contenido en espa√±ol te invito a delegar en mi Pool</p>
									</blockquote>
									
								</article>

						</div>
					</div>
				</section>

			<!-- Footer -->
				<div id="footer">
					<!-- Copyright -->
					<div class="copyright">
						<ul class="menu">
							<li>&copy; TricahuePool 2019. All rights reserved</li><li>Design: <a href="http://html5up.net">HTML5 UP</a>
						</ul>
					</div>

				</div>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>